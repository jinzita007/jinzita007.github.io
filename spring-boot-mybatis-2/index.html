

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="../assets/css/main.css?v=5e892d17e0" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="../assets/css/screen.css?v=5e892d17e0">
    <link rel="stylesheet" href="https://highlightjs.org/static/demo/styles/github.css">
    <script src="https://cdn.bootcss.com/highlight.js/9.15.6/highlight.min.js"></script>
    

    <title></title>
     <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
    <link rel="canonical" href="index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="amp/index.html">
    
    <meta property="og:site_name" content="无根树の博客">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Spring Boot + Mybatis 创建CRUD应用(注解)">
    <meta property="og:description" content="使用Spring Boot Mybatis实现数据的增删改查（CRUD) 图书表：我们为CRUD操作创建了一个表格。 schema.sql CREATE TABLE `book` (   `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '图书ID',   `title` varchar(50) NOT NULL COMMENT '图书名',   `author` varchar(32) NOT NULL COMMENT '图书作者',   PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8; data.sql INSERT INTO book (`id`, `title`, `author`">
    <meta property="og:url" content="http://localhost:2368/spring-boot-mybatis-2/">
    <meta property="article:published_time" content="2018-02-02T06:38:28.000Z">
    <meta property="article:modified_time" content="2018-02-02T06:32:50.000Z">
    <meta property="article:tag" content="Spring Boot">
    <meta property="article:tag" content="MyBatis">
    <meta property="article:tag" content="CRUD">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Spring Boot + Mybatis 创建CRUD应用(注解)">
    <meta name="twitter:description" content="使用Spring Boot Mybatis实现数据的增删改查（CRUD)">
    <meta name="twitter:url" content="http://localhost:2368/spring-boot-mybatis-2/">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="Spring Boot, MyBatis, CRUD">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "无根树の博客",
        "logo": {
            "@type": "ImageObject",
            "url": "http://localhost:2368/favicon.ico",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "",
        "url": "http://localhost:2368/author/",
        "sameAs": []
    },
    "headline": "Spring Boot + Mybatis 创建CRUD应用(注解)",
    "url": "http://localhost:2368/spring-boot-mybatis-2/",
    "datePublished": "2018-02-02T06:38:28.000Z",
    "dateModified": "2018-02-02T06:32:50.000Z",
    "keywords": "Spring Boot, MyBatis, CRUD",
    "description": "使用Spring Boot Mybatis实现数据的增删改查（CRUD) 图书表：我们为CRUD操作创建了一个表格。 schema.sql CREATE TABLE &#x60;book&#x60; (   &#x60;id&#x60; int(11) NOT NULL AUTO_INCREMENT COMMENT &#x27;图书ID&#x27;,   &#x60;title&#x60; varchar(50) NOT NULL COMMENT &#x27;图书名&#x27;,   &#x60;author&#x60; varchar(32) NOT NULL COMMENT &#x27;图书作者&#x27;,   PRIMARY KEY (&#x60;id&#x60;)) ENGINE&#x3D;InnoDB DEFAULT CHARSET&#x3D;utf8; data.sql INSERT INTO book (&#x60;id&#x60;, &#x60;title&#x60;, &#x60;author&#x60;",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:2368/"
    }
}
    </script>

    <script type="text/javascript" src="../public/ghost-sdk.min.js?v=5e892d17e0"></script>
<script type="text/javascript">
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "a41d73990106"
});
</script>
    <meta name="generator" content="Ghost 1.20">
    <link rel="alternate" type="application/rss+xml" title="无根树の博客" href="../rss/index.html">
</head>

<body class="post-template tag-spring-boot tag-mybatis tag-crud">

    
 <div class="header">
    <div class="header-inder">
        <nav class="site-navs">
            <div class="site-nav-left">
                <a class="site-nav-logo" href="../">无根树の博客</a>
                  <ul class="nav" role="menu">
    <li class="nav-" role="menuitem"><a href="../">首页</a></li>
    <li class="nav-" role="menuitem"><a href="../records/">归档</a></li>
    <li class="nav-" role="menuitem"><a href="../tags/">标签</a></li>
    <li class="nav-github" role="menuitem"><a href="https://github.com/jinzita007">github</a></li>
</ul>
 
            </div>
            <div class="site-nav-right">
                <form class="form-inline my-2 my-lg-0">
                    <input id="search-field" class="form-control mr-sm-2" type="text" placeholder="Search">
                    <!--<button class="btn btn-secondary my-2 my-sm-0" type="submit">搜索</button>-->
                </form>
            </div>

        </nav>
    </div>
</div>
<section id="results-main">
    <ul id="results" class="results-search">
    </ul>
</section>
    <div class="container">
        <div class="wrap">
            <div class="content-main">
                 
                <div class="content-title">
                    <h1>Spring Boot + Mybatis 创建CRUD应用(注解)</h1>
                    <span class="post-main">
                        <span class="post-time">
                            <span class="post-meta-item-icon">
                                <i class="fa fa-calendar-o"></i>
                            </span>
                            <time class="post-meta-time">2018-02-02</time>
                        </span>  |   
                        <span class="tags">
                             <a href="../tag/spring-boot/">Spring Boot</a> <a href="../tag/mybatis/">MyBatis</a> <a href="../tag/crud/">CRUD</a>
                        </span>
                    </span>
                </div>
                <div class="content-dec">
                    
                    <div class="kg-card-markdown"><blockquote>
<p>使用Spring Boot Mybatis实现数据的增删改查（CRUD)</p>
</blockquote>
<p>图书表：我们为CRUD操作创建了一个表格。</p>
<blockquote>
<p>schema.sql</p>
</blockquote>
<pre><code class="language-sql">CREATE TABLE `book` (
  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '图书ID',
  `title` varchar(50) NOT NULL COMMENT '图书名',
  `author` varchar(32) NOT NULL COMMENT '图书作者',
  PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8;
</code></pre>
<blockquote>
<p>data.sql</p>
</blockquote>
<pre><code class="language-sql">INSERT INTO book (`id`, `title`, `author`) VALUES
(1, '三重门', '韩寒'),
(2, '飘', '玛格丽特·米切尔'),
(3, '简爱', '夏洛蒂·勃朗特'),
(4, '活着', '余华');
</code></pre>
<blockquote>
<p>启动服务创建表和插入表</p>
</blockquote>
<p><img src="../content/images/2018/02/Snip20180202_15.png" alt="Snip20180202_15"></p>
<blockquote>
<p>注意的是：schema.sql是创建表，data.sql是插入表。要是Spring Boot启动的话,会自动创建表和插入mysql数据库里面的。</p>
</blockquote>
<blockquote>
<p>book图书表</p>
</blockquote>
<pre><code class="language-sql">mysql&gt; select * from book;
+----+-----------+-------------------------+
| id | title     | author                  |
+----+-----------+-------------------------+
|  1 | 三重门    | 韩寒                    |
|  2 | 飘        | 玛格丽特·米切尔         |
|  3 | 简爱      | 夏洛蒂·勃朗特           |
|  4 | 活着      | 余华                    |
+----+-----------+-------------------------+
4 rows in set (0.00 sec)
</code></pre>
<h3 id="controller">controller</h3>
<ul>
<li>一个典型的CRUD案例</li>
</ul>
<blockquote>
<p>src/main/com.zyl.app/controller/BookController.java</p>
</blockquote>
<pre><code class="language-java">package com.zyl.app.controller;

import com.zyl.app.domain.Book;
import com.zyl.app.service.BookService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

@RestController
@RequestMapping("/api")
public class BookController {

    @Autowired
    private BookService bookService;
    
    @RequestMapping(value = "/books", method = RequestMethod.GET)
    public List&lt;Book&gt; findAll() {
        List&lt;Book&gt; books = bookService.findAll();
        return books;
    }

    @RequestMapping(value = "/book/{id}", method = RequestMethod.GET)
    public Book findOne(@PathVariable("id") Long id) {
        Book books = bookService.findOne(id);
        return books;
    }

    @RequestMapping(value = "/book", method = RequestMethod.POST)
    public Book save(@ModelAttribute Book book) {
        bookService.save(book);
        return book;
    }
    
    @RequestMapping(value = "/book/{id}", method = RequestMethod.PUT)
    public Map&lt;String, String&gt; update(@PathVariable("id") Long id, @ModelAttribute Book book) {
        Map&lt;String, String&gt; results = new HashMap&lt;String, String&gt;();
        book.setId(id);
        bookService.update(book);

        return results;
    }

    @RequestMapping(value = "/book/{id}", method = RequestMethod.DELETE)
    public void delete(@PathVariable("id") Long id) {
       bookService.delete(id);
    }

}
</code></pre>
<h3 id="domain">domain</h3>
<ul>
<li>Book实体类定义</li>
</ul>
<blockquote>
<p>src/main/com.zyl.app/domain/Book.java</p>
</blockquote>
<pre><code class="language-java">package com.zyl.app.domain;

public class Book {

    private Long id;       //图书ID
    private String title;  //图书名
    private String author;  //图书作者

    public Book() {
        super();
    }
    public Book(Long id, String title, String author) {
        super();
        this.id = id;
        this.title = title;
        this.author = author;
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title;
    }

    public String getAuthor() {
        return author;
    }

    public void setAuthor(String author) {
        this.author = author;
    }

    @Override
    public String toString() {
        return "Book{" +
                "id=" + id +
                ", title='" + title + '\'' +
                ", author='" + author + '\'' +
                '}';
    }
}
</code></pre>
<h3 id="service">service</h3>
<ul>
<li>从这里Book给mybatis处理</li>
<li>BookMapper将在这之后处理mybatis</li>
</ul>
<blockquote>
<p>src/main/com.zyl.app/service/BookService.java</p>
</blockquote>
<pre><code class="language-java">package com.zyl.app.service;

import com.zyl.app.domain.Book;
import com.zyl.app.mapper.BookMapper;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;

@Service
public class BookService {

    @Autowired
    private BookMapper bookMapper;

    @Transactional
    public List&lt;Book&gt; findAll() {
        return bookMapper.findAll();
    }

    @Transactional
    public Book findOne(Long id) {
        return bookMapper.findOne(id);
    }

    @Transactional
    public void save(Book book) {
        bookMapper.save(book);
    }

    @Transactional
    public void update(Book book) {
        bookMapper.update(book);
    }

    @Transactional
    public void delete(Long id) {
        bookMapper.delete(id);
    }
}
</code></pre>
<h3 id="">基本模式</h3>
<blockquote>
<p>依赖</p>
</blockquote>
<ul>
<li>其他模式通用</li>
<li>添加mybatis依赖到pom.xml</li>
</ul>
<pre><code>&lt;dependency&gt;
      &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;
      &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;
      &lt;version&gt;1.3.1&lt;/version&gt;
    &lt;/dependency&gt;
</code></pre>
<h3 id="mapper">mapper</h3>
<blockquote>
<p>src/main/com.zyl.app/mapper/BookMapper.java</p>
</blockquote>
<pre><code class="language-java">package com.zyl.app.mapper;

import com.zyl.app.domain.Book;
import org.apache.ibatis.annotations.*;

import java.util.List;

@Mapper
public interface BookMapper {

    @Select("select * from book")
    List&lt;Book&gt; findAll();

    @Select("select * from book where id = #{id}")
    Book findOne(Long id);

    @Insert("insert into book (title, author) values (#{title}, #{author})")
    void save(Book book);

    @Update("update book set title = #{title}, author = #{author} where id = #{id}")
    void update(Book book);

    @Delete("delete from book where id = #{id}")
    void delete(Long id);
}
</code></pre>
<blockquote>
<p>将数据库连接信息添加到application.properties</p>
</blockquote>
<pre><code>spring.datasource.url=jdbc:mysql://localhost:3306/mydb
spring.datasource.username=root
spring.datasource.password=root
spring.datasource.driver-class-name=com.mysql.jdbc.Driver
</code></pre>
<blockquote>
<p>动作确认</p>
</blockquote>
<pre><code># 查询图书列表
curl -v http://localhost:8080/api/books
# 查询图书ID
curl -v http://localhost:8080/api/book/1
# 创建一个图书
curl -v -XPOST --data "title=灵魂的事&amp;author=史铁生0" http://localhost:8080/api/book/
# 更新一个图书
curl -v -XPUT --data "title=灵魂的事&amp;author=史铁生" http://localhost:8080/api/book/5
# 删除图书
curl -v -XDELETE http://localhost:8080/api/book/5
</code></pre>
<blockquote>
<p>查询图书列表</p>
</blockquote>
<pre><code>Last login: Fri Feb  2 14:18:19 on ttys004
You have new mail.
$ curl -v http://localhost:8080/api/books
*   Trying ::1...
* TCP_NODELAY set
* Connected to localhost (::1) port 8080 (#0)
&gt; GET /api/books HTTP/1.1
&gt; Host: localhost:8080
&gt; User-Agent: curl/7.51.0
&gt; Accept: */*
&gt; 
&lt; HTTP/1.1 200 
&lt; Content-Type: application/json;charset=UTF-8
&lt; Transfer-Encoding: chunked
&lt; Date: Fri, 02 Feb 2018 08:45:10 GMT
&lt; 
* Curl_http_done: called premature == 0
* Connection #0 to host localhost left intact
[{"id":1,"title":"三重门","author":"韩寒"},{"id":2,"title":"飘","author":"玛格丽特·米切尔"},{"id":3,"title":"简爱","author":"夏洛蒂·勃朗特"},{"id":4,"title":"活着","author":"余华"}]
</code></pre>
<blockquote>
<p>查询图书ID</p>
</blockquote>
<pre><code>$ curl -v http://localhost:8080/api/book/1
*   Trying ::1...
* TCP_NODELAY set
* Connected to localhost (::1) port 8080 (#0)
&gt; GET /api/book/1 HTTP/1.1
&gt; Host: localhost:8080
&gt; User-Agent: curl/7.51.0
&gt; Accept: */*
&gt; 
&lt; HTTP/1.1 200 
&lt; Content-Type: application/json;charset=UTF-8
&lt; Transfer-Encoding: chunked
&lt; Date: Fri, 02 Feb 2018 08:53:04 GMT
&lt; 
* Curl_http_done: called premature == 0
* Connection #0 to host localhost left intact
{"id":1,"title":"三重门","author":"韩寒"}
</code></pre>
<blockquote>
<p>创建一个图书</p>
</blockquote>
<pre><code>$ curl -v -XPOST --data "title=灵魂的事&amp;autho/=史铁生0" http://localhost:8080/api/book 
Note: Unnecessary use of -X or --request, POST is already inferred.
*   Trying ::1...
* TCP_NODELAY set
* Connected to localhost (::1) port 8080 (#0)
&gt; POST /api/book/ HTTP/1.1
&gt; Host: localhost:8080
&gt; User-Agent: curl/7.51.0
&gt; Accept: */*
&gt; Content-Length: 36
&gt; Content-Type: application/x-www-form-urlencoded
&gt; 
* upload completely sent off: 36 out of 36 bytes
&lt; HTTP/1.1 200 
&lt; Content-Type: application/json;charset=UTF-8
&lt; Transfer-Encoding: chunked
&lt; Date: Fri, 02 Feb 2018 08:54:06 GMT
&lt; 
* Curl_http_done: called premature == 0
* Connection #0 to host localhost left intact
{"id":null,"title":"灵魂的事","author":"史铁生0"}
</code></pre>
<blockquote>
<p>看看有没创建一个图书</p>
</blockquote>
<pre><code class="language-sql">mysql&gt; select * from book;
+----+--------------+-------------------------+
| id | title        | author                  |
+----+--------------+-------------------------+
|  1 | 三重门       | 韩寒                    |
|  2 | 飘           | 玛格丽特·米切尔         |
|  3 | 简爱         | 夏洛蒂·勃朗特           |
|  4 | 活着         | 余华                    |
|  5 | 灵魂的事     | 史铁生0                 |
+----+--------------+-------------------------+
5 rows in set (0.00 sec)
</code></pre>
<blockquote>
<p>更新一个图书</p>
</blockquote>
<pre><code>$ curl -v -XPUT --data "title=灵魂的事&amp;author=史铁生" http://localhost:8080/api/book/5
*   Trying ::1...
* TCP_NODELAY set
* Connected to localhost (::1) port 8080 (#0)
&gt; PUT /api/book/5 HTTP/1.1
&gt; Host: localhost:8080
&gt; User-Agent: curl/7.51.0
&gt; Accept: */*
&gt; Content-Length: 35
&gt; Content-Type: application/x-www-form-urlencoded
&gt; 
* upload completely sent off: 35 out of 35 bytes
&lt; HTTP/1.1 200 
&lt; Content-Type: application/json;charset=UTF-8
&lt; Transfer-Encoding: chunked
&lt; Date: Fri, 02 Feb 2018 09:08:13 GMT
&lt; 
* Curl_http_done: called premature == 0
* Connection #0 to host localhost left intact
</code></pre>
<blockquote>
<p>查询图书列表,看看是否更新</p>
</blockquote>
<pre><code class="language-sql">mysql&gt; mysql&gt; select * from book;
+----+--------------+-------------------------+
| id | title        | author                  |
+----+--------------+-------------------------+
|  1 | 三重门       | 韩寒                    |
|  2 | 飘           | 玛格丽特·米切尔         |
|  3 | 简爱         | 夏洛蒂·勃朗特           |
|  4 | 活着         | 余华                    |
|  5 | 灵魂的事     | 史铁生                  |
+----+--------------+-------------------------+
5 rows in set (0.00 sec)
</code></pre>
<blockquote>
<p>删除图书</p>
</blockquote>
<pre><code>$ curl -v -XDELETE http://localhost:8080/api/book/5
*   Trying ::1...
* TCP_NODELAY set
* Connected to localhost (::1) port 8080 (#0)
&gt; DELETE /api/book/5 HTTP/1.1
&gt; Host: localhost:8080
&gt; User-Agent: curl/7.51.0
&gt; Accept: */*
&gt; 
&lt; HTTP/1.1 200 
&lt; Content-Length: 0
&lt; Date: Fri, 02 Feb 2018 09:10:01 GMT
&lt; 
* Curl_http_done: called premature == 0
* Connection #0 to host localhost left intact
</code></pre>
<blockquote>
<p>查询图书列表，是否删除一个图书ID=5</p>
</blockquote>
<pre><code class="language-sql">mysql&gt; select * from book;
+----+-----------+-------------------------+
| id | title     | author                  |
+----+-----------+-------------------------+
|  1 | 三重门    | 韩寒                    |
|  2 | 飘        | 玛格丽特·米切尔         |
|  3 | 简爱      | 夏洛蒂·勃朗特           |
|  4 | 活着      | 余华                    |
+----+-----------+-------------------------+
4 rows in set (0.00 sec)
</code></pre>
<blockquote>
<p>这样完成了CRUD功能，刚才是第一种方案（不包括XML，注解MyBatis）还有另一种方案就是MyBatis XML设置.</p>
</blockquote>
<blockquote>
<p>Github项目地址：<a href="https://github.com/jinzita007/SpringMybatisDemo">Spring Boot + Mybatis CRUD应用(注解Mybatis)</a></p>
</blockquote>
</div>
                </div>

            </div>
        </div>
    </div>

    <script>
   
    </script> 


</body>
<script src="https://cdn.bootcss.com/jquery/2.2.0/jquery.min.js"></script>
<script src="../assets/js/jquery.ghostHunter.js?v=5e892d17e0" type="text/javascript"></script>
<script>

    //实时监听input框输入值并增加搜索
    var input = document.getElementById('search-field');
    $("#search-field").ghostHunter({
        results: "#results",
        onKeyUp: true,
        displaySearchInfo: false,
        before: function () {
            input.oninput = function () {
                //如果输入值为空时，列表内容就显示出来
                if (input.value === '') {
                    //console.log(input.value);
                    $(".wrap-active").removeClass("results-hide");
                } else {
                    //如果输入值为有字符，列表内容就隐藏
                    //console.log(input.value);
                    $(".wrap-active").addClass("results-hide");
                }
            }
        }
    });

</script>
<script>hljs.initHighlightingOnLoad();</script>


